<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="co.makeu.up.faq.service.FaqMapper">
	<select id="faqSelectList" resultType="co.makeu.up.faq.service.FaqVO">
		SELECT * FROM FAQ
		WHERE F_ST_CODE = 'F01'
		ORDER BY F_NO
	</select>
	
	<select id="faqList" resultType="co.makeu.up.faq.service.FaqVO" parameterType="co.makeu.up.faq.service.FaqVO">
		SELECT * 
		FROM (SELECT ROWNUM RN, W.*
		      FROM(SELECT F.F_NO, CT.CODE_NAME CTGR, F.Q_CONTENT, C.CODE_NAME F_ST_CODE, F.WR_DATE, F.A_CONTENT,COUNT(*) OVER() length
			  	  FROM FAQ F JOIN COMM_CODE C
				  ON F.F_ST_CODE = C.CODE_ID
				  JOIN COMM_CODE CT
				  ON F.CTGR = CT.CODE_ID
				  WHERE 1 = 1
				  <if test="qcontent != null and qcontent != ''">
				  AND F.Q_CONTENT LIKE '%' || #{qcontent}  || '%'
				  </if>
				  <if test="ctgr != null and ctgr != ''">
				  AND F.CTGR = #{ctgr}
				  </if>
				  <if test="start != null and start != ''">
		          <![CDATA[
		          AND TO_DATE(#{start}, 'YYYY-MM-DD') <  F.WR_DATE
		          ]]>
		          </if>
		          <if test="end != null and end != ''">
		          <![CDATA[
		          AND TO_DATE(#{end}, 'YYYY-MM-DD')  > F.WR_DATE
		          ]]>
		          </if>
				  <if test="fstcode != null and fstcode != ''">
				  AND F.F_ST_CODE = #{fstcode}
				  </if>
				  ORDER BY F.F_NO DESC) W)
		 <![CDATA[
	    WHERE RN > (#{pageNum}-1) * #{amount} 
	    AND RN <= #{pageNum} * #{amount}
	    ]]>
	</select>
</mapper>