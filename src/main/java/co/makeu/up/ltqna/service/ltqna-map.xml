<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="co.makeu.up.ltqna.service.LtQnaMapper">
	<select id="selectQnaList" resultType="co.makeu.up.ltqna.service.LtQnaVO" parameterType="co.makeu.up.ltqna.service.LtQnaVO">
		SELECT * FROM
		    ( SELECT ROWNUM RN, L.*
		    FROM LT_QNA L
			WHERE ROWNUM <![CDATA[<=]]> 10 * (#{page}+1) 
	        AND LT_NO = #{ltNo}
	        AND (Q_CONTENT LIKE '%'||#{contentSearchKey}||'%'
	        	AND WRITER LIKE '%'||#{writerSearchKey}||'%')
	        ORDER BY Q_REG_DATE DESC, CODE_NAME)
        WHERE RN <![CDATA[>=]]> (10*${page})+1
	</select>
	<select id="selectMyQnaList" parameterType="co.makeu.up.ltqna.service.LtQnaVO" resultType="co.makeu.up.ltqna.service.LtQnaVO">
		SELECT * FROM LT_QNA
		WHERE LT_NO = #{ltNo}
		AND WRITER = #{writer}
		ORDER BY Q_REG_DATE
	</select>
	<select id="qnaListCnt" parameterType="Integer" resultType="Integer">
		SELECT COUNT(*) FROM LT_QNA
		WHERE LT_NO = #{ltNo}
	</select>
	<select id="selectQna" resultType="co.makeu.up.ltqna.service.LtQnaVO" parameterType="co.makeu.up.ltqna.service.LtQnaVO">
		SELECT * FROM LT_QNA WHERE QNA_NO = #{qnaNo}
	</select>
	<insert id="insertQna" parameterType="co.makeu.up.ltqna.service.LtQnaVO">
		INSERT INTO LT_QNA VALUES(
		NVL((SELECT MAX(QNA_NO) FROM LT_QNA)+1,1),NULL,#{qContent},#{ltNo},NULL,SYSDATE,'Q01',#{writer}
		)
	</insert>
</mapper>