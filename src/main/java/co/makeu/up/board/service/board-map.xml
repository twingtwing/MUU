<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="co.makeu.up.board.service.BoardMapper">
	<select id="selectBoardList" resultType="co.makeu.up.board.service.BoardVO">
		SELECT B_NO,TTL,CONTENT,B_ST_CODE,WR_DATE,HITS, NVL(FILE_NO,-1) FILE_NO
		FROM BOARD
		WHERE b_st_code = 'B01'
		ORDER BY b_no DESC
	</select>
	
	<select id="selectBoard" resultType="co.makeu.up.board.service.BoardVO" parameterType="co.makeu.up.board.service.BoardVO">
	SELECT  *
	FROM (SELECT  b_no, ttl, content, wr_date, hits ,NVL(file_no,-1) file_no,
	        LAG(b_no,1,-1) OVER(ORDER BY b_no) AS PREBNO,LAG(ttl,1,null) OVER(ORDER BY b_no) AS PREBTTL,
	        LEAD(b_no,1,-1) OVER(ORDER BY b_no) AS NEXTBNO, LEAD(ttl,1,null) OVER(ORDER BY b_no) AS NEXTBTTl
	        FROM BOARD )
	WHERE b_no = #{bNo}
	</select>
	
	
	<update id="upboard" parameterType="co.makeu.up.board.service.BoardVO">
	UPDATE BOARD SET HITS = NVL(HITS,0) +1 
	WHERE B_NO= #{bNo}
	</update>
	
	<select id="selectadbad" resultType="co.makeu.up.board.service.BoardVO" parameterType="co.makeu.up.board.service.BoardVO">
	select b_no, ttl, content, wr_date, hits ,NVL(file_no,-1) file_no
	from board
	order by b_no desc
	</select>
	
	<insert id="insertBoard" parameterType="co.makeu.up.board.service.BoardVO">
		insert into board (b_no,ttl,content,wr_date,B_ST_CODE)
		values ((select NVL (max(b_no),0)+1 from board),#{ttl},#{content},SYSDATE,'B01')
	</insert>
	
	<select id="selectadbads" resultType="co.makeu.up.board.service.BoardVO" parameterType="co.makeu.up.board.service.BoardVO">
	select b_no , ttl,content ,wr_date,hits,b_st_code
	from board
	where b_no = #{bNo}
	</select>
	
	<update id="deladbad" parameterType="co.makeu.up.board.service.BoardVO">
		update board set b_st_code = 'B02'
		where b_no = #{bNo}
	
	</update>
	
	<update id="upadbad" parameterType="co.makeu.up.board.service.BoardVO">
	 update board
    set ttl = #{ttl} , content = #{content}
    where b_no = #{bNo}
	</update>
</mapper>